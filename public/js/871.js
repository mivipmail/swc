"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[871],{871:(t,e,n)=>{n.r(e),n.d(e,{default:()=>f});var r=n(821),l={key:0,class:"table"},o=(0,r._)("thead",null,[(0,r._)("tr",null,[(0,r._)("th",null,"Ошибка")])],-1),i={class:"border-0"},u={key:1,class:"table"},s=(0,r._)("p",{class:"pt-3"},[(0,r._)("strong",null,"Участники")],-1),a={key:0},d={key:1},v={class:"border-0"};const c={name:"Event",data:function(){return{event:null,error:null}},mounted:function(){this.getEvent(),this.startTimer()},beforeDestroy:function(){this.stopTimer()},watch:{$route:function(t,e){this.getEvent()}},methods:{getEvent:function(){var t=this;this.error=null;var e=this.$route.params.id;e&&axios.get("/api/events/".concat(e)).then((function(e){null!=e&&e.data.result?t.event=null==e?void 0:e.data.result:(t.event=null,t.error=null==e?void 0:e.data.error)})).catch((function(t){console.log("err",t.response)}))},followEvent:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];axios.post("/api/events/".concat(e?"":"un","follow/").concat(this.event.id)).then((function(e){null!=e&&e.data.result?(t.event=e.data.result,t.$store.dispatch("getEvents")):console.log(null==e?void 0:e.data.error)})).catch((function(t){console.log(t)}))},destroyEvent:function(){var t=this;axios.delete("/api/events/".concat(this.event.id)).then((function(e){t.$router.push({name:"user.index"})})).catch((function(t){console.log(t)}))},stopTimer:function(){this.interval&&window.clearInterval(this.interval)},startTimer:function(){var t=this;this.stopTimer(),this.interval=window.setInterval((function(){t.getEvent()}),3e4)}}};const f=(0,n(744).Z)(c,[["render",function(t,e,n,c,f,h){var m,b,w,_,g,p,k,y,E,D,$=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[f.error?((0,r.wg)(),(0,r.iD)("table",l,[o,(0,r._)("tbody",null,[(0,r._)("tr",null,[(0,r._)("td",i,(0,r.zw)(f.error),1)])])])):(0,r.kq)("",!0),f.event?((0,r.wg)(),(0,r.iD)("table",u,[(0,r._)("thead",null,[(0,r._)("tr",null,[(0,r._)("th",null,(0,r.zw)(null===(m=f.event)||void 0===m?void 0:m.title),1)])]),(0,r._)("tbody",null,[(0,r._)("tr",null,[(0,r._)("td",null,(0,r.zw)(null===(b=f.event)||void 0===b?void 0:b.content),1)]),(0,r._)("tr",null,[(0,r._)("td",null,"Дата создания: "+(0,r.zw)(null===(w=f.event)||void 0===w?void 0:w.created_at),1)]),(0,r._)("tr",null,[(0,r._)("td",null,"Создал: "+(0,r.zw)(null===(_=f.event)||void 0===_?void 0:_.creator_user.name)+" "+(0,r.zw)(null===(g=f.event)||void 0===g?void 0:g.creator_user.surname),1)]),(0,r._)("tr",null,[(0,r._)("td",null,[s,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(null===(p=f.event)||void 0===p?void 0:p.member_users,(function(t){return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)($,{to:{name:"user.show",params:{id:t.id}},class:"bd-links-link d-inline-block rounded"},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,r.zw)(t.name)+" "+(0,r.zw)(t.surname),1)]})),_:2},1032,["to"])])})),256))])]),t.$store.getters.me?((0,r.wg)(),(0,r.iD)("tr",a,[(0,r._)("td",null,[null!==(k=f.event)&&void 0!==k&&k.member_users.find((function(e){return e.id===t.$store.getters.me.id}))?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("button",{key:0,onClick:e[0]||(e[0]=(0,r.iM)((function(){return h.followEvent(!0)}),["prevent"])),type:"button",class:"btn btn-primary btn-sm"}," Принять участие ")),null!==(y=f.event)&&void 0!==y&&y.member_users.find((function(e){return e.id===t.$store.getters.me.id}))?((0,r.wg)(),(0,r.iD)("button",{key:1,onClick:e[1]||(e[1]=(0,r.iM)((function(){return h.followEvent(!1)}),["prevent"])),type:"button",class:"btn btn-outline-primary btn-sm"}," Отказаться от участия ")):(0,r.kq)("",!0)])])):(0,r.kq)("",!0),t.$store.getters.me&&(null===(E=f.event)||void 0===E?void 0:E.creator_user.id)===t.$store.getters.me.id?((0,r.wg)(),(0,r.iD)("tr",d,[(0,r._)("td",v,[(null===(D=f.event)||void 0===D?void 0:D.creator_user.id)===t.$store.getters.me.id?((0,r.wg)(),(0,r.iD)("button",{key:0,onClick:e[2]||(e[2]=(0,r.iM)((function(){return h.destroyEvent&&h.destroyEvent.apply(h,arguments)}),["prevent"])),type:"button",class:"btn btn-danger btn-sm"}," Удалить ")):(0,r.kq)("",!0)])])):(0,r.kq)("",!0)])])):(0,r.kq)("",!0)],64)}]])}}]);